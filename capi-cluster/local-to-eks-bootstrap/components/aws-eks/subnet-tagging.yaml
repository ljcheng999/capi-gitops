apiVersion: batch/v1
kind: Job
metadata:
  name: subnet-tagging
  namespace: default
spec:
  ttlSecondsAfterFinished: 10
  template:
    spec:
      serviceAccountName: capa-role-local-sa
      containers:
        - name: subnet-tagging
          image: amazon/aws-cli:latest
          command:
            - aws
            - ec2
            - create-tags
            - "--resources"
            - subnet-1234 #priv-1a
            - subnet-1234 #priv-1b
            - "--tags"
            - "Key=kubernetes.io/cluster/<cluster_name>,Value=owned"
      restartPolicy: Never
  backoffLimit: 2
